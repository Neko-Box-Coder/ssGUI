<!DOCTYPE html>

<html class="NDPage NDContentPage"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>07. Cloning GUI Objects.txt</title><link rel="stylesheet" type="text/css" href="../../styles/main.css" /><script type="text/javascript" src="../../styles/main.js"></script><script type="text/javascript">NDLoader.LoadJS("Content", "../../styles/");</script></head>

<!-- Generated by Natural Docs, version 2.3 (Development Release 1) -->

<!-- saved from url=(0016)http://localhost -->

<body onload="NDLoader.OnLoad('Content');">

<script type="text/javascript">var q = window.location.search;if (q.indexOf("?Theme=") == 0){var t = q.slice(7);var e = t.indexOf(";");if (e != -1){  t = t.slice(0, e);  }if (document.documentElement.className == undefined){ document.documentElement.className = t + "Theme"; }else{ document.documentElement.className += " " + t + "Theme"; }}</script>

<a name="🖇️_Cloning_GUI_Objects"></a><a name="Topic1656"></a><div class="CTopic TSection LTextFile first">
 <div class="CTitle">🖇️ Cloning GUI Objects</div>
 <div class="CBody"><p>When you have a hierarchy of GUI Objects,</p><p>it is good to be able to clone GUI objects <b>including their children (and recursively)</b>.</p><p>⠀</p><p>Luckily, ssGUI does provide such functionality,</p><p>by calling the <a href="../../index.html#File:◀️_ssGUI_API_▶️/GUIObjectClasses/GUIObject.hpp:ssGUI.GUIObject.Clone" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,1132);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >ssGUI::GUIObject::Clone</a> function which has the option</p><p>to clone only the GUI Object or together with the children recursively.</p><p>⠀</p><p>That is all fine and well until the GUI object (or children) you are cloning <b>references some other GUI Objects</b>.</p><p>Then things get complicated.</p><p>For example, if your button changes an attribute of another GUI Object under the same parent (recursively) that will be cloned.</p><p>⠀</p><p>This is why <a href="../../index.html#File:◀️_ssGUI_API_▶️/DataClasses/ObjectsReferences.hpp:ssGUI.ObjectsReferences" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,567);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >ssGUI::ObjectsReferences</a> exists.</p><p>The job of this class is to track all the references between the GUI object and other GUI objects</p><p>and map the references correctly and automatically when the GUI objects being cloned or deleted.</p></div>
</div>

<a name="Example"></a><a name="Topic51"></a><div class="CTopic TSection LTextFile last">
 <div class="CTitle">Example</div>
 <div class="CBody"><p>As an example, we have a window that can be cloned by hitting the &quot;Enter&quot; key.</p><p>And inside that window, we have a text widget and button which the text changes when the button is pressed.</p><div class="CImage"><a href="../../images/CloningExample.gif" target="_blank" class="ZoomLink"><img src="../../images/CloningExample.gif" loading="lazy" class="KnownDimensions" width="731" height="343" style="max-width: 731px" alt="CloningExample" /></a></div><pre class="CCode"><span class="SHComment">//...</span><br /><br /><span class="SHComment">//Create a window</span><br />ssGUI::StandardWindow window;<br /><br /><span class="SHComment">//Create a text widget and set the respective properties</span><br />ssGUI::Text text;<br /><br /><span class="SHComment">//Create a button and set an event callback to change the text when it is clicked</span><br />ssGUI::StandardButton button;<br /><br /><span class="SHComment">//...</span><br /><br /><span class="SHComment">//By default, button has state changed event callback attached to it</span><br /><span class="SHComment">//Gets the event callback for the button state change</span><br />auto ecb = button.GetAnyEventCallback&lt;ssGUI::EventCallbacks::ButtonStateChangedEventCallback&gt;();<br />ecb-&gt;AddEventListener<br />(<br />    <span class="SHString">&quot;AnyKey&quot;</span>,<br />    [&amp;](ssGUI::GUIObject* src, ssGUI::GUIObject* container, ssGUI::ObjectsReferences* refs)<br />    {<br />        <span class="SHComment">//When the button is clicked, sets the text</span><br />        <span class="SHKeyword">if</span>(static_cast&lt;ssGUI::Button*&gt;(container)-&gt;GetButtonState() == ssGUI::Enums::ButtonState::CLICKED)<br />            text.SetText(L<span class="SHString">&quot;(`oωo´)&quot;</span>);<br />    }<br />);<br /><br /><span class="SHComment">//Create the GUIManager, add the main window and start running</span><br />ssGUI::ssGUIManager guiManager;<br /><br /><span class="SHComment">//When the user presses Enter, clone the window</span><br />guiManager.AddPostGUIUpdateEventListener<br />(<br />    [&amp;]()<br />    {<br />        ssGUI::Backend::BackendSystemInputInterface* inputInterface = guiManager.GetBackendInputInterface();<br /><br />        <span class="SHKeyword">if</span>(inputInterface-&gt;GetCurrentKeyPresses().IsSystemKeyPresent(ssGUI::Enums::SystemKey::ENTER) &amp;&amp;<br />            !inputInterface-&gt;GetLastKeyPresses().IsSystemKeyPresent(ssGUI::Enums::SystemKey::ENTER))<br />        {<br />            window.Clone(<span class="SHKeyword">true</span>)-&gt;SetPosition(glm::vec2(window.GetPosition().x + <span class="SHNumber">10</span>, window.GetPosition().y + <span class="SHNumber">10</span>));<br />        }<br />    }<br />);<br /><br /><span class="SHComment">//...</span></pre><p>The expected behaviour is to change the text when the button is clicked <b>under the cloned window</b>.</p><p>But let's see what actually happens instead.</p><div class="CImage"><a href="../../images/CloningExample2.gif" target="_blank" class="ZoomLink"><img src="../../images/CloningExample2.gif" loading="lazy" class="KnownDimensions" width="731" height="343" style="max-width: 731px" alt="CloningExample2" /></a></div><p>As you can see, the button under the cloned window is changing the <b>original text</b> instead of the cloned one.</p><p>This is because the cloned button is referencing the original text instead.</p><div class="CImage"><a href="../../images/CloningExplain.png" target="_blank" class="ZoomLink"><img src="../../images/CloningExplain.png" loading="lazy" class="KnownDimensions" width="706" height="328" style="max-width: 706px" alt="CloningExplain" /></a></div><p>If we use <a href="../../index.html#File:◀️_ssGUI_API_▶️/DataClasses/ObjectsReferences.hpp:ssGUI.ObjectsReferences" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,567);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >ssGUI::ObjectsReferences</a>, it will keep track of the references automatically if you add the objects to be referenced.</p><p>And it will change the <b>cloned text</b> instead.</p><pre class="CCode"><span class="SHComment">//...</span><br /><br /><span class="SHComment">//By default, button has state changed event callback attached to it</span><br /><span class="SHComment">//Gets the event callback for the button state change</span><br />auto ecb = button.GetAnyEventCallback&lt;ssGUI::EventCallbacks::ButtonStateChangedEventCallback&gt;();<br /><br /><span class="SHComment">//Adds the text widget parented to the window to the event callback so it can be referenced</span><br /><span class="SHComment">//&lt;AddObjectReference&gt; return a &lt;ssGUIObjectIndex&gt; which is just an ID you can use to retrieve the text widget back</span><br />ssGUI::ssGUIObjectIndex textIndex = ecb-&gt;AddObjectReference(&amp;text);<br />ecb-&gt;AddEventListener<br />(<br />    <span class="SHString">&quot;AnyKey&quot;</span>,<br />    [textIndex](ssGUI::GUIObject* src, ssGUI::GUIObject* container, ssGUI::ObjectsReferences* refs)<br />    {<br />        <span class="SHComment">//When the button is clicked, sets the text</span><br />        <span class="SHKeyword">if</span>(static_cast&lt;ssGUI::Button*&gt;(container)-&gt;GetButtonState() == ssGUI::Enums::ButtonState::CLICKED)<br />        {<br />            ssGUI::Text* text = static_cast&lt;ssGUI::Text*&gt;(refs-&gt;GetObjectReference(textIndex));<br />            text-&gt;SetText(L<span class="SHString">&quot;(`oωo´)&quot;</span>);<br />        }<br />    }<br />);<br /><br /><span class="SHComment">//...</span></pre><div class="CImage"><a href="../../images/CloningExample3.gif" target="_blank" class="ZoomLink"><img src="../../images/CloningExample3.gif" loading="lazy" class="KnownDimensions" width="731" height="343" style="max-width: 731px" alt="CloningExample3" /></a></div></div>
</div>

</body></html>