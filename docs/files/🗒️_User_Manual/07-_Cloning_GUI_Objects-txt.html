<!DOCTYPE html>

<html class="NDPage NDContentPage"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>07. Cloning GUI Objects.txt</title><link rel="stylesheet" type="text/css" href="../../styles/main.css" /><script type="text/javascript" src="../../styles/main.js"></script><script type="text/javascript">NDLoader.LoadJS("Content", "../../styles/");</script></head>

<!-- Generated by Natural Docs, version 2.3 (Development Release 1) -->

<!-- saved from url=(0016)http://localhost -->

<body onload="NDLoader.OnLoad('Content');">

<script type="text/javascript">var q = window.location.search;if (q.indexOf("?Theme=") == 0){var t = q.slice(7);var e = t.indexOf(";");if (e != -1){  t = t.slice(0, e);  }if (document.documentElement.className == undefined){ document.documentElement.className = t + "Theme"; }else{ document.documentElement.className += " " + t + "Theme"; }}</script>

<a name="Cloning_GUI_Objects"></a><a name="Topic1656"></a><div class="CTopic TSection LTextFile first">
 <div class="CTitle">Cloning GUI Objects</div>
 <div class="CBody"><p>When you have a hierarchy of GUI Objects, it is good to be able to clone GUI objects including their children (and recursively).</p><p>Luckily, ssGUI does provide such functionality, by calling the <a href="../../index.html#File:◀️_ssGUI_API_▶️/GUIObjectClasses/GUIObject.hpp:ssGUI.GUIObject.Clone" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,1132);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >ssGUI::GUIObject::Clone</a> function which has the option to clone only the GUI Object or together with the children recursively.</p><p>That is all fine and well until the GUI object (or children) you are cloning references some other GUI Objects.&nbsp; Then things get complicated.</p><p>This is why <a href="../../index.html#File:◀️_ssGUI_API_▶️/DataClasses/ObjectsReferences.hpp:ssGUI.ObjectsReferences" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,567);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >ssGUI::ObjectsReferences</a> exists. The job of this class is to track all the references between the GUI object and other GUI objects and map the references correctly and automatically when the GUI objects being cloned or deleted.</p><p>Let's take a look at the modified readme example.&nbsp; The modification is just moving the message from the <a href="../../index.html#File:◀️_ssGUI_API_▶️/GUIObjectClasses/MainWindow.hpp:ssGUI.MainWindow" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,1236);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >ssGUI::MainWindow</a> to <a href="../../index.html#File:◀️_ssGUI_API_▶️/GUIObjectClasses/Window.hpp:ssGUI.Window" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,1076);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >ssGUI::Window</a>, and the ability to clone that window by pressing the &quot;Enter&quot; key.</p><div class="CImage"><a href="../../images/CloningExample.png" target="_blank" class="ZoomLink"><img src="../../images/CloningExample.png" loading="lazy" class="KnownDimensions" width="727" height="355" style="max-width: 727px" alt="CloningExample" /></a></div><pre class="CCode">#include <span class="SHString">&quot;ssGUI/HeaderGroups/StandardGroup.hpp&quot;</span><br />#include <span class="SHString">&quot;ssGUI/DebugAndBuild/ssGUIBuildAndDebugConfig.hpp&quot;</span><br /><br /><span class="SHKeyword">int</span> main()<br />{<br />    <span class="SHComment">//Create the main window</span><br />    ssGUI::MainWindow mainWindow;<br />    mainWindow.SetSize(glm::ivec2(<span class="SHNumber">700</span>, <span class="SHNumber">300</span>));<br /><br />    <span class="SHComment">//Create a window</span><br />    ssGUI::Window window;<br />    window.SetSize(glm::ivec2(<span class="SHNumber">450</span>, <span class="SHNumber">110</span> + window.GetTitlebarHeight()));      <span class="SHComment">//The reason why adding titlebar height is because Window includes titlebar while MainWindow doesn't</span><br />    window.SetResizeType(ssGUI::Enums::ResizeType::NONE);<br />    window.SetParent(&amp;mainWindow);<br /><br />    <span class="SHComment">//Create a text widget and set the respective properties</span><br />    ssGUI::Text text;<br />    text.SetSize(glm::vec2(<span class="SHNumber">450</span>, <span class="SHNumber">45</span>));<br />    text.SetText(L<span class="SHString">&quot;Click on the button to show the message&quot;</span>);<br />    text.SetHorizontalAlignment(ssGUI::Enums::TextAlignmentHorizontal::CENTER);<br />    text.SetVerticalAlignment(ssGUI::Enums::TextAlignmentVertical::BOTTOM);<br />    text.SetParent(&amp;window);<br /><br />    <span class="SHComment">//Create a button and set an event callback to change the text when it is clicked</span><br />    ssGUI::Button button;<br />    button.SetSize(glm::ivec2(<span class="SHNumber">50</span>, <span class="SHNumber">30</span>));<br />    button.SetPosition(glm::vec2(<span class="SHNumber">200</span>, <span class="SHNumber">60</span>));<br />    button.SetParent(&amp;window);<br /><br />    <span class="SHComment">//Gets the event callback for the button state change</span><br />    auto ecb = button.GetAnyEventCallback&lt;ssGUI::EventCallbacks::ButtonStateChangedEventCallback&gt;();<br />    ecb-&gt;AddEventListener<br />    (<br />        <span class="SHString">&quot;AnyId&quot;</span>,<br />        [&amp;](ssGUI::GUIObject* src, ssGUI::GUIObject* container, ssGUI::ObjectsReferences* refs)<br />        {<br />            <span class="SHKeyword">if</span>(((ssGUI::Button*)src)-&gt;GetButtonState() == ssGUI::Enums::ButtonState::CLICKED)<br />                text.SetText(L<span class="SHString">&quot;(`oωo´)&quot;</span>);<br />        }<br />    );<br /><br />    <span class="SHComment">//Create the GUIManager, add the main window and start running</span><br />    ssGUI::ssGUIManager guiManager;<br /><br />    <span class="SHComment">//When the user presses Enter, clone the window</span><br />    guiManager.AddOnUpdateEventListener<br />    (<br />        [&amp;]()<br />        {<br />            ssGUI::Backend::BackendSystemInputInterface* inputInterface = guiManager.GetBackendInputInterface();<br /><br />            <span class="SHKeyword">if</span>(inputInterface-&gt;GetCurrentKeyPresses().IsSystemKeyPresent(ssGUI::Enums::SystemKey::ENTER) &amp;&amp;<br />                !inputInterface-&gt;GetLastKeyPresses().IsSystemKeyPresent(ssGUI::Enums::SystemKey::ENTER))<br />            {<br />                window.Clone(<span class="SHKeyword">true</span>)-&gt;SetPosition(glm::vec2(window.GetPosition().x + <span class="SHNumber">10</span>, window.GetPosition().y + <span class="SHNumber">10</span>));<br />            }<br />        }<br />    );<br /><br />    guiManager.AddGUIObject((ssGUI::GUIObject*)&amp;mainWindow);<br />    guiManager.StartRunning();<br />    <span class="SHKeyword">return</span> <span class="SHNumber">0</span>;<br />}</pre><p>Remember this is not utilizing the <a href="../../index.html#File:◀️_ssGUI_API_▶️/DataClasses/ObjectsReferences.hpp:ssGUI.ObjectsReferences" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,567);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >ssGUI::ObjectsReferences</a> class at all and look at the what happens if I press on the button:</p><div class="CImage"><a href="../../images/CloningWithoutOR.gif" target="_blank" class="ZoomLink"><img src="../../images/CloningWithoutOR.gif" loading="lazy" class="KnownDimensions" width="723" height="348" style="max-width: 723px" alt="CloningWithoutOR" /></a></div><p>So when you press on the button from a cloned window, it doesn't change the text that was cloned.&nbsp; Instead, it is changing the original text.</p><p>For most of the scenarios, this is not the desired output.&nbsp; So what can we do to allow the button (Event listener to be accurate) to reference (and change) the cloned text instead?</p><p>This is what the <a href="../../index.html#File:◀️_ssGUI_API_▶️/DataClasses/ObjectsReferences.hpp:ssGUI.ObjectsReferences" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,567);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >ssGUI::ObjectsReferences</a> class comes into play.</p><p>The only thing we need to modify in order for it to work is to add the text to as reference and use that in the event listener instead.</p><pre class="CCode">...<br />ssGUI::Text text;<br />...<br /><span class="SHComment">//Gets the event callback for the button state change</span><br />auto ecb = button.GetAnyEventCallback&lt;ssGUI::EventCallbacks::ButtonStateChangedEventCallback&gt;();<br /><br /><span class="SHComment">//Adds the text widget parented to the window to the event callback so it can be referenced</span><br /><span class="SHComment">//&lt;AddObjectReference&gt; return a &lt;ssGUIObjectIndex&gt; which is just an ID you can use to retrieve the text widget back</span><br />ssGUI::ssGUIObjectIndex textIndex = ecb-&gt;AddObjectReference(&amp;text);<br />ecb-&gt;AddEventListener<br />(<br />    <span class="SHString">&quot;AnyId&quot;</span>,<br />    [textIndex](ssGUI::GUIObject* src, ssGUI::GUIObject* container, ssGUI::ObjectsReferences* refs)<br />    {<br />        <span class="SHKeyword">if</span>(((ssGUI::Button*)src)-&gt;GetButtonState() == ssGUI::Enums::ButtonState::CLICKED)<br />        {<br />            ssGUI::GUIObject* refText = refs-&gt;GetObjectReference(textIndex);<br /><br />            <span class="SHKeyword">if</span>(refText != nullptr)<br />                static_cast&lt;ssGUI::Text*&gt;(refText)-&gt;SetText(L<span class="SHString">&quot;(`oωo´)&quot;</span>);<br />        }<br />    }<br />);<br />...</pre><p>This might be overkill for a small cloning like this but you can imagine it would be quite a pain if you cloning a GUI object with a lot of children (recursively as well) and have to manage all the referencing by yourself.</p><p>The only thing you will need to be careful about is <a href="../../index.html#File:◀️_ssGUI_API_▶️/DataClasses/ObjectsReferences.hpp:ssGUI.ObjectsReferences.GetObjectReference" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,571);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >ssGUI::ObjectsReferences::GetObjectReference</a> can return a nullptr if it cannot resolve the reference. Therefore you should keep in mind to have a nullptr check just in case.</p><p>So this will be what the whole code looks like with <a href="../../index.html#File:◀️_ssGUI_API_▶️/DataClasses/ObjectsReferences.hpp:ssGUI.ObjectsReferences" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,567);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >ssGUI::ObjectsReferences</a> utilized.</p><div class="CImage"><a href="../../images/CloningWithOR.gif" target="_blank" class="ZoomLink"><img src="../../images/CloningWithOR.gif" loading="lazy" class="KnownDimensions" width="723" height="348" style="max-width: 723px" alt="CloningWithOR" /></a></div><pre class="CCode">#include <span class="SHString">&quot;ssGUI/HeaderGroups/StandardGroup.hpp&quot;</span><br />#include <span class="SHString">&quot;ssGUI/DebugAndBuild/ssGUIBuildAndDebugConfig.hpp&quot;</span><br /><br /><span class="SHKeyword">int</span> main()<br />{<br />    <span class="SHComment">//Create the main window</span><br />    ssGUI::MainWindow mainWindow;<br />    mainWindow.SetSize(glm::ivec2(<span class="SHNumber">700</span>, <span class="SHNumber">300</span>));<br /><br />    <span class="SHComment">//Create a window</span><br />    ssGUI::Window window;<br />    window.SetSize(glm::ivec2(<span class="SHNumber">450</span>, <span class="SHNumber">110</span> + window.GetTitlebarHeight()));      <span class="SHComment">//The reason why adding titlebar height is because Window includes titlebar while MainWindow doesn't</span><br />    window.SetResizeType(ssGUI::Enums::ResizeType::NONE);<br />    window.SetParent(&amp;mainWindow);<br /><br />    <span class="SHComment">//Create a text widget and set the respective properties</span><br />    ssGUI::Text text;<br />    text.SetSize(glm::vec2(<span class="SHNumber">450</span>, <span class="SHNumber">45</span>));<br />    text.SetText(L<span class="SHString">&quot;Click on the button to show the message&quot;</span>);<br />    text.SetHorizontalAlignment(ssGUI::Enums::TextAlignmentHorizontal::CENTER);<br />    text.SetVerticalAlignment(ssGUI::Enums::TextAlignmentVertical::BOTTOM);<br />    text.SetParent(&amp;window);<br /><br />    <span class="SHComment">//Create a button and set an event callback to change the text when it is clicked</span><br />    ssGUI::Button button;<br />    button.SetSize(glm::ivec2(<span class="SHNumber">50</span>, <span class="SHNumber">30</span>));<br />    button.SetPosition(glm::vec2(<span class="SHNumber">200</span>, <span class="SHNumber">60</span>));<br />    button.SetParent(&amp;window);<br /><br />    <span class="SHComment">//Gets the event callback for the button state change</span><br />    auto ecb = button.GetAnyEventCallback&lt;ssGUI::EventCallbacks::ButtonStateChangedEventCallback&gt;();<br /><br />    <span class="SHComment">//Adds the text widget parented to the window to the event callback so it can be referenced</span><br />    <span class="SHComment">//&lt;AddObjectReference&gt; return a &lt;ssGUIObjectIndex&gt; which is just an ID you can use to retrieve the text widget back</span><br />    ssGUI::ssGUIObjectIndex textIndex = ecb-&gt;AddObjectReference(&amp;text);<br />    ecb-&gt;AddEventListener<br />    (<br />        <span class="SHString">&quot;AnyKey&quot;</span>,<br />        [textIndex](ssGUI::GUIObject* src, ssGUI::GUIObject* container, ssGUI::ObjectsReferences* refs)<br />        {<br />            <span class="SHKeyword">if</span>(((ssGUI::Button*)src)-&gt;GetButtonState() == ssGUI::Enums::ButtonState::CLICKED)<br />            {<br />                ssGUI::GUIObject* refText = refs-&gt;GetObjectReference(textIndex);<br /><br />                <span class="SHKeyword">if</span>(refText != nullptr)<br />                    static_cast&lt;ssGUI::Text*&gt;(refText)-&gt;SetText(L<span class="SHString">&quot;(`oωo´)&quot;</span>);<br />            }<br />        }<br />    );<br /><br />    <span class="SHComment">//Create the GUIManager, add the main window and start running</span><br />    ssGUI::ssGUIManager guiManager;<br /><br />    <span class="SHComment">//When the user presses Enter, clone the window</span><br />    guiManager.AddOnUpdateEventListener<br />    (<br />        [&amp;]()<br />        {<br />            ssGUI::Backend::BackendSystemInputInterface* inputInterface = guiManager.GetBackendInputInterface();<br /><br />            <span class="SHKeyword">if</span>(inputInterface-&gt;GetCurrentKeyPresses().IsSystemKeyPresent(ssGUI::Enums::SystemKey::ENTER) &amp;&amp;<br />                !inputInterface-&gt;GetLastKeyPresses().IsSystemKeyPresent(ssGUI::Enums::SystemKey::ENTER))<br />            {<br />                window.Clone(<span class="SHKeyword">true</span>)-&gt;SetPosition(glm::vec2(window.GetPosition().x + <span class="SHNumber">10</span>, window.GetPosition().y + <span class="SHNumber">10</span>));<br />            }<br />        }<br />    );<br /><br />    guiManager.AddGUIObject((ssGUI::GUIObject*)&amp;mainWindow);<br />    guiManager.StartRunning();<br />    <span class="SHKeyword">return</span> <span class="SHNumber">0</span>;<br />}</pre></div>
</div>

</body></html>